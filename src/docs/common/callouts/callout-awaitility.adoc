Use https://github.com/awaitility/awaitility[Awaitility] to test asynchronous code. By default, `Awaitility` waits for 10 seconds and if the condition is not fulfilled during this time, it throws a `ConditionTimeoutException` failing the test.