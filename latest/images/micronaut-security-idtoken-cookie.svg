<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns:xl="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="105 112 1120 1651" width="1120" height="1651">
  <defs>
    <marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker" stroke-linejoin="miter" stroke-miterlimit="10" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="black">
      <g>
        <path d="M 8 0 L 0 -3 L 0 3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/>
      </g>
    </marker>
    <marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker_2" stroke-linejoin="miter" stroke-miterlimit="10" viewBox="-9 -4 10 8" markerWidth="10" markerHeight="8" color="black">
      <g>
        <path d="M -8 0 L 0 3 L 0 -3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/>
      </g>
    </marker>
  </defs>
  <g id="idtoken_cookie" stroke-dasharray="none" stroke-opacity="1" fill="none" fill-opacity="1" stroke="none">
    <title>idtoken cookie</title>
    <g id="idtoken_cookie_Layer_1">
      <title>Layer 1</title>
      <g id="Graphic_2">
        <rect x="105.52734" y="112.5" width="189" height="127.5" fill="white"/>
        <rect x="105.52734" y="112.5" width="189" height="127.5" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(110.52734 167.026)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="59.884" y="15" xml:space="preserve">Browser</tspan>
        </text>
      </g>
      <g id="Graphic_4">
        <rect x="577.5625" y="112.5" width="189" height="127.5" fill="white"/>
        <rect x="577.5625" y="112.5" width="189" height="127.5" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(582.5625 167.026)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="36.74" y="15" xml:space="preserve">Micronaut App</tspan>
        </text>
      </g>
      <g id="Graphic_12">
        <rect x="200.27734" y="240" width=".5" height="1522" fill="white"/>
        <rect x="200.27734" y="240" width=".5" height="1522" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Line_14">
        <line x1="269.51367" y1="456.78516" x2="592.6763" y2="454.9318" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_16">
        <text transform="translate(343.45292 426.08594)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="55422333e-20" y="15" xml:space="preserve">GET /oauth/login/provider</tspan>
        </text>
      </g>
      <g id="Graphic_20">
        <rect x="1018.7832" y="112.5" width="189" height="127.5" fill="white"/>
        <rect x="1018.7832" y="112.5" width="189" height="127.5" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1023.7832 167.026)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="30.228" y="15" xml:space="preserve">OpenID Provider</tspan>
        </text>
      </g>
      <g id="Graphic_21">
        <rect x="671.3125" y="379" width=".5" height="1300" fill="white"/>
        <rect x="671.3125" y="379" width=".5" height="1300" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_22">
        <rect x="1113.5332" y="240" width=".5" height="1512.5" fill="white"/>
        <rect x="1113.5332" y="240" width=".5" height="1512.5" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Line_24">
        <line x1="725.8916" y1="480.6758" x2="1049.0543" y2="478.8224" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_23">
        <text transform="translate(793.75085 449.97656)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="4973799e-19" y="15" xml:space="preserve">GET Authorization endpoint</tspan>
        </text>
      </g>
      <g id="Graphic_26">
        <rect x="1035.0391" y="491.7031" width="189" height="127.5" fill="white"/>
        <rect x="1035.0391" y="491.7031" width="189" height="127.5" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1040.0391 496.7031)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="6.508" y="15" xml:space="preserve">Authenticate in OpenID </tspan>
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="59.724" y="33.448" xml:space="preserve">Provider</tspan>
        </text>
      </g>
      <g id="Graphic_27">
        <rect x="1063" y="536" width="136.832" height="19" fill="white"/>
        <rect x="1063" y="536" width="136.832" height="19" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1068 536.276)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="49.336" y="15" xml:space="preserve">*****</tspan>
        </text>
      </g>
      <g id="Graphic_28">
        <rect x="1063" y="564.5039" width="136.832" height="19" fill="white"/>
        <rect x="1063" y="564.5039" width="136.832" height="19" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1068 564.7799)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="49.336" y="15" xml:space="preserve">*****</tspan>
        </text>
      </g>
      <g id="Graphic_29">
        <rect x="1063" y="593.0078" width="136.832" height="19" fill="white"/>
        <rect x="1063" y="593.0078" width="136.832" height="19" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1068 593.2838)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="43.56" y="15" xml:space="preserve">Login</tspan>
        </text>
      </g>
      <g id="Line_31">
        <line x1="735.7914" y1="660.53185" x2="1058.9541" y2="658.6785" marker-start="url(#FilledArrow_Marker_2)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_30">
        <text transform="translate(754.63885 635.2305)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="0" y="15" xml:space="preserve">GET or POST /oauth/callback/provider</tspan>
        </text>
      </g>
      <g id="Line_33">
        <line x1="725.8916" y1="735.7632" x2="1049.0543" y2="733.9098" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_32">
        <text transform="translate(813.5828 705.064)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="1563194e-19" y="15" xml:space="preserve">POST Token Endpoint</tspan>
        </text>
      </g>
      <g id="Graphic_34">
        <rect x="1035.0391" y="748.3633" width="189" height="82.63672" fill="white"/>
        <rect x="1035.0391" y="748.3633" width="189" height="82.63672" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1040.0391 770.4576)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="23.404" y="15" xml:space="preserve">Validate token and </tspan>
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="22.26253" y="33.448" xml:space="preserve">generate </tspan>
          <tspan font-family="Courier New" font-size="16" fill="black" y="33.448" xml:space="preserve">idtoken</tspan>
        </text>
      </g>
      <g id="Line_36">
        <line x1="735.7914" y1="868.8927" x2="1058.9541" y2="867.0393" marker-start="url(#FilledArrow_Marker_2)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_35">
        <text transform="translate(832.1509 843.5913)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="8384404e-19" y="15" xml:space="preserve">Token Response</tspan>
        </text>
      </g>
      <g id="Graphic_37">
        <text transform="translate(858.8174 880.8804)" fill="black">
          <tspan font-family="Courier New" font-size="16" fill="black" x="0" y="13" xml:space="preserve">idtoken</tspan>
        </text>
      </g>
      <g id="Line_39">
        <line x1="719.3955" y1="967.375" x2="1042.5582" y2="965.5216" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_38">
        <text transform="translate(799.2308 936.6758)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="0" y="15" xml:space="preserve">Fetch in JWKS endpoint</tspan>
        </text>
      </g>
      <g id="Line_41">
        <line x1="729.29535" y1="1041.9825" x2="1052.458" y2="1040.1292" marker-start="url(#FilledArrow_Marker_2)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_40">
        <text transform="translate(826.6948 1016.6812)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="0" y="15" xml:space="preserve">GET public keys</tspan>
        </text>
      </g>
      <g id="Graphic_42">
        <rect x="577.0625" y="1065.8005" width="189" height="82.63672" fill="white"/>
        <rect x="577.0625" y="1065.8005" width="189" height="82.63672" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(582.0625 1087.8949)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="7.142531" y="15" xml:space="preserve">Validate </tspan>
          <tspan font-family="Courier New" font-size="16" fill="black" y="15" xml:space="preserve">idtoken</tspan>
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" y="15" xml:space="preserve"> JWT </tspan>
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="15.7" y="35" xml:space="preserve">signature and claims</tspan>
        </text>
      </g>
      <g id="Line_44">
        <line x1="279.4135" y1="1409.713" x2="602.5762" y2="1407.8596" marker-start="url(#FilledArrow_Marker_2)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_43">
        <text transform="translate(408.0609 1384.4116)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="37658765e-20" y="15" xml:space="preserve">200 OK</tspan>
        </text>
      </g>
      <g id="Graphic_45">
        <text transform="translate(330.94267 1419.0327)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="0" y="15" xml:space="preserve">Set-Cookie: JWT=</tspan>
          <tspan font-family="Courier New" font-size="16" fill="black" y="15" xml:space="preserve">newtoken</tspan>
        </text>
      </g>
      <g id="Line_47">
        <line x1="269.51367" y1="318.18237" x2="592.6763" y2="316.329" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_46">
        <text transform="translate(393.5249 287.48315)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="43343107e-20" y="15" xml:space="preserve">GET /books</tspan>
        </text>
      </g>
      <g id="Line_49">
        <line x1="279.4135" y1="363.8131" x2="602.5762" y2="361.9597" marker-start="url(#FilledArrow_Marker_2)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_48">
        <text transform="translate(384.4689 342.77466)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="0" y="15" xml:space="preserve">303 See Other</tspan>
        </text>
      </g>
      <g id="Graphic_50">
        <text transform="translate(249.49292 374.86987)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="0" y="15" xml:space="preserve">Redirect micronaut.security.redirect.unauthorized.url</tspan>
        </text>
      </g>
      <g id="Line_53">
        <line x1="270.51367" y1="1482.012" x2="593.6763" y2="1480.1586" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_52">
        <text transform="translate(393.5249 1456.6538)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="43343107e-20" y="15" xml:space="preserve">GET /books</tspan>
        </text>
      </g>
      <g id="Graphic_51">
        <text transform="translate(344.83067 1491.2749)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="8952838e-19" y="15" xml:space="preserve">Cookie: JWT= </tspan>
          <tspan font-family="Courier New" font-size="16" fill="black" y="15" xml:space="preserve">newtoken</tspan>
        </text>
      </g>
      <g id="Line_56">
        <line x1="280.4135" y1="1737.7772" x2="603.5762" y2="1735.9238" marker-start="url(#FilledArrow_Marker_2)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_55">
        <text transform="translate(409.0609 1712.4758)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="37658765e-20" y="15" xml:space="preserve">200 OK</tspan>
        </text>
      </g>
      <g id="Graphic_66">
        <rect x="585.8125" y="1497.3711" width="172.5" height="221.6289" fill="white"/>
        <rect x="585.8125" y="1497.3711" width="172.5" height="221.6289" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(590.8125 1502.3711)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="32.218" y="15" xml:space="preserve">Security Filter</tspan>
        </text>
      </g>
      <g id="Graphic_65">
        <rect x="596.40625" y="1525.5" width="150.9375" height="74.71483" fill="white"/>
        <rect x="596.40625" y="1525.5" width="150.9375" height="74.71483" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(601.40625 1530.5)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="8.04875" y="10" xml:space="preserve">TokenAuthenticationFetcher</tspan>
        </text>
      </g>
      <g id="Graphic_64">
        <rect x="613.0586" y="1610.293" width="53.90625" height="38.984677" fill="white"/>
        <rect x="613.0586" y="1610.293" width="53.90625" height="38.984677" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(618.0586 1617.5053)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="3.713125" y="10" xml:space="preserve">Security </tspan>
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="11.953125" y="22.28" xml:space="preserve">Rule</tspan>
        </text>
      </g>
      <g id="Graphic_63">
        <rect x="677.16016" y="1610.293" width="53.90625" height="38.984677" fill="white"/>
        <rect x="677.16016" y="1610.293" width="53.90625" height="38.984677" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(682.16016 1617.5053)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="3.713125" y="10" xml:space="preserve">Security </tspan>
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="11.953125" y="22.28" xml:space="preserve">Rule</tspan>
        </text>
      </g>
      <g id="Graphic_62">
        <rect x="613.0586" y="1664.4908" width="53.90625" height="38.984677" fill="white"/>
        <rect x="613.0586" y="1664.4908" width="53.90625" height="38.984677" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(618.0586 1671.703)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="3.713125" y="10" xml:space="preserve">Security </tspan>
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="11.953125" y="22.28" xml:space="preserve">Rule</tspan>
        </text>
      </g>
      <g id="Graphic_61">
        <rect x="677.16016" y="1664.4908" width="53.90625" height="38.984677" fill="white"/>
        <rect x="677.16016" y="1664.4908" width="53.90625" height="38.984677" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(682.16016 1671.703)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="3.713125" y="10" xml:space="preserve">Security </tspan>
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="11.953125" y="22.28" xml:space="preserve">Rule</tspan>
        </text>
      </g>
      <g id="Graphic_60">
        <rect x="599.7324" y="1550.3743" width="53.90625" height="38.984677" fill="white"/>
        <rect x="599.7324" y="1550.3743" width="53.90625" height="38.984677" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(604.7324 1551.4466)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="6.213125" y="10" xml:space="preserve">Cookie</tspan>
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="8.708125" y="22.28" xml:space="preserve">Token</tspan>
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="5.843125" y="34.559998" xml:space="preserve">Reader</tspan>
        </text>
      </g>
      <g id="Line_59">
        <line x1="653.6387" y1="1569.4534" x2="679.0875" y2="1569.0633" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_58">
        <rect x="689.4863" y="1550.3743" width="53.90625" height="38.984677" fill="white"/>
        <rect x="689.4863" y="1550.3743" width="53.90625" height="38.984677" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(694.4863 1557.5866)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="8.708125" y="10" xml:space="preserve">Token</tspan>
          <tspan font-family="Helvetica Neue" font-size="10" fill="black" x="2.508125" y="22.28" xml:space="preserve">Validator</tspan>
        </text>
      </g>
      <g id="Graphic_57">
        <text transform="translate(803.9778 1556.7668)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="20.71775" y="15" xml:space="preserve">Validate </tspan>
          <tspan font-family="Courier New" font-size="16" fill="black" y="15" xml:space="preserve">newtoken </tspan>
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="15.7" y="35" xml:space="preserve">signature and claims</tspan>
        </text>
      </g>
      <g id="Graphic_67">
        <rect x="577.0625" y="1172.1985" width="189" height="82.63672" fill="white"/>
        <rect x="577.0625" y="1172.1985" width="189" height="82.63672" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(582.0625 1194.2928)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="12.470531" y="15" xml:space="preserve">Map </tspan>
          <tspan font-family="Courier New" font-size="16" fill="black" y="15" xml:space="preserve">idtoken</tspan>
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" y="15" xml:space="preserve"> claims </tspan>
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="30.38" y="35" xml:space="preserve">into a new token</tspan>
        </text>
      </g>
      <g id="Graphic_68">
        <rect x="585.8125" y="1282.4963" width="189" height="82.63672" fill="white"/>
        <rect x="585.8125" y="1282.4963" width="189" height="82.63672" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(590.8125 1314.5907)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" fill="black" x="22.972" y="15" xml:space="preserve">Sign the newtoken</tspan>
        </text>
      </g>
    </g>
  </g>
</svg>
