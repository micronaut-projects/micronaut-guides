<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1'/>
    <title>Securely store Micronaut Application secrets in Oracle Cloud Vault</title>
    <link rel='stylesheet' id='wp-block-library-css' href='https://micronaut.io/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all'/>
    <link rel='stylesheet' id='fonts-fira-sans-css' href='https://fonts.googleapis.com/css2?family=Fira+Sans%3Awght%40300%3B500&#038;display=swap&#038;ver=5.7' type='text/css' media='all'/>
    <link rel='stylesheet' id='micronaut-style-css' href='https://micronaut.io/wp-content/themes/micronaut/style.min.css' type='text/css' media='all'/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="icon" href="https://micronaut.io/wp-content/uploads/2021/02/favicon.ico" type="image/png">
    <link rel="shortcut icon" href="https://micronaut.io/wp-content/uploads/2021/02/favicon.ico" type="image/png">
    <link href="coderay.css" rel="stylesheet" />
    <link href="guide.css" rel="stylesheet" />
    <script src="guide.js"></script>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image" content="https://guides.micronaut.io/latest/images/cards/micronaut-cloud-secrets-oracle.png"/>
    <meta name="twitter:creator" content="@micronautfw"/>
    <meta name="twitter:site" content="@micronautfw"/>
    <meta name="twitter:title" content="Securely store Micronaut Application secrets in Oracle Cloud Vault"/>
    <meta name="twitter:description" content="Learn how to create secrets in Oracle Cloud Vault and easily access them in a Micronaut application."/>
</head>
<body class="page-template page-template-page-sidebar page-template-page-sidebar-php page page-parent guide">

<header id="header">

    <div class="container">

        <nav class="navbar navbar-expand-lg navbar-dark">

            <button class="collapsed" type="button" data-toggle="collapse" data-target="#nav" aria-expanded="false">
                <span></span>
            </button>

            <a class="navbar-brand" href="https://micronaut.io">
                <img src="https://micronaut.io/wp-content/uploads/2020/11/MIcronautLogo_Horizontal.svg" alt="Micronaut framework"/>
            </a>

            <div class="collapse navbar-collapse" id="nav">

                <ul class="navbar-nav ml-auto">

                    <li id="menu-item-2865" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2865 nav-item">
                        <a href="https://micronaut.io/download/" class="nav-link">Download</a>
                    </li>
                    <li id="menu-item-2868" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-22 current_page_item current-menu-ancestor current-menu-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-2872 active dropdown nav-item">
                        <a href="./index.html" class="nav-link dropdown-toggle" data-toggle="dropdown">Learn</a>
                        <ul class="dropdown-menu">
                            <li id="menu-item-2869" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2869">
                                <a href="https://micronaut.io/docs/" class="dropdown-item">User Documentation</a>
                            </li>
                            <li id="menu-item-2870" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2870">
                                <a href="./index.html" class="dropdown-item">Guides</a>
                            </li>
                            <li id="menu-item-2896" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2896">
                                <a href="https://micronaut.io/category/microcast/" class="dropdown-item">Microcasts</a>
                            </li>
                            <li id="menu-item-2897" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2897">
                                <a href="https://micronaut.io/category/webinar/" class="dropdown-item">Webinars</a>
                            </li>
                            <li id="menu-item-2871" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2871">
                                <a href="https://micronaut.io/professional-training/" class="dropdown-item">Professional Training</a>
                            </li>
                        </ul>
                    </li>
                    <li id="menu-item-2878" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2878 dropdown nav-item">
                        <a href="https://micronaut.io/blog/" class="nav-link dropdown-toggle" data-toggle="dropdown">Resources</a>
                        <ul class="dropdown-menu">
                            <li id="menu-item-2879" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2879">
                                <a href="https://micronaut.io/blog/" class="dropdown-item">Blog</a>
                            </li>
                            <li id="menu-item-2881" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2881">
                                <a href="https://micronaut.io/events/" class="dropdown-item">Upcoming Events</a>
                            </li>
                            <li id="menu-item-2880" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2880">
                                <a href="https://micronaut.io/commercial-support/" class="dropdown-item">Commercial Support</a>
                            </li>
                            <li id="menu-item-2882" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2882">
                                <a href="https://micronaut.io/faq/" class="dropdown-item">FAQ</a>
                            </li>
                            <li id="menu-item-2883" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2883">
                                <a href="https://micronaut.io/contact/" class="dropdown-item">Contact</a>
                            </li>
                        </ul>
                    </li>
                    <li id="menu-item-2872" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2878 dropdown nav-item">
                        <a href="https://micronaut.io/foundation/" aria-current="page" class="nav-link dropdown-toggle" data-toggle="dropdown">Foundation</a>
                        <ul class="dropdown-menu">
                            <li id="menu-item-2877" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-22 current_page_item menu-item-2877 active">
                                <a href="https://micronaut.io/foundation/" aria-current="page" class="dropdown-item">Overview</a>
                            </li>
                            <li id="menu-item-2874" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2874">
                                <a href="https://micronaut.io/foundation/corporate-sponsorship/" class="dropdown-item">Corporate Sponsorship</a>
                            </li>
                            <li id="menu-item-2873" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2873">
                                <a href="https://micronaut.io/foundation/community-sponsorship/" class="dropdown-item">Community Sponsorship</a>
                            </li>
                            <li id="menu-item-2876" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2876">
                                <a href="https://micronaut.io/foundation/sponsors/" class="dropdown-item">Sponsors</a>
                            </li>
                        </ul>
                    </li>
                    <li id="menu-item-2884" class="action menu-item menu-item-type-custom menu-item-object-custom menu-item-2884 nav-item">
                        <a target="_blank" rel="noopener" href="https://micronaut.io/launch/" class="nav-link">Launch</a>
                    </li>
                </ul>
            </div>

        </nav>

    </div>
</header>
<div id="breadcrumbs"><div class="container"><a href="https://micronaut.io/">Home</a> » <a href="./index.html">Guides</a> » <a href="micronaut-cloud-secrets-oracle.html">Securely store Micronaut Application secrets in Oracle Cloud Vault</a> » <span class="breadcrumb_last" aria-current="page">gradle | kotlin</span></div></div><!-- .breadcrumbs -->
<main id="main">
    <div class="container">
        <div class="row">
            <div class="col-md-4">

                <div class="toc">
                    <div class="inner">
                        <h1 class="title title_large first-word-bold first-word-break">Table of Contents</h1>
                        <div class="underline"></div>
                        
<ul class="sectlevel1">
<li><a href="#getting-started">1. Getting Started</a></li>
<li><a href="#what-you-will-need">2. What you will need</a></li>
<li><a href="#oracle-cloud-vault">3. Oracle Cloud Vault</a></li>
<li><a href="#the-application">4. The Application</a></li>
<li><a href="#creating-an-oracle-cloud-vault">5. Creating an Oracle Cloud Vault</a>
<ul class="sectlevel2">
<li><a href="#compartment-ocid">5.1. Compartment OCID</a></li>
<li><a href="#create-the-vault">5.2. Create the Vault</a></li>
</ul>
</li>
<li><a href="#using-vault-with-micronaut">6. Using Vault with Micronaut</a>
<ul class="sectlevel2">
<li><a href="#micronaut-oraclecloud-vault-dependency">6.1. micronaut-oraclecloud-vault Dependency</a></li>
</ul>
</li>
<li><a href="#distributed-configuration">7. Distributed Configuration</a>
<ul class="sectlevel2">
<li><a href="#enable-distributed-configuration">7.1. Enable Distributed Configuration</a></li>
<li><a href="#clean-up-application-configuration">7.2. Clean up Application Configuration</a></li>
<li><a href="#disable-distributed-configuration-for-test">7.3. Disable Distributed Configuration for Test</a></li>
</ul>
</li>
<li><a href="#configuration-changes">8. Configuration changes</a>
<ul class="sectlevel2">
<li><a href="#bootstrap-oraclecloud-yml">8.1. bootstrap-oraclecloud.yml</a></li>
</ul>
</li>
<li><a href="#mysql-database">9. MySQL Database</a></li>
<li><a href="#deploying-the-application">10. Deploying the Application</a></li>
<li><a href="#configuring-mysql-access">11. Configuring MySQL Access</a></li>
<li><a href="#creating-secrets">12. Creating Secrets</a>
<ul class="sectlevel2">
<li><a href="#jdbc_user">12.1. JDBC_USER</a></li>
<li><a href="#jdbc_password">12.2. JDBC_PASSWORD</a></li>
<li><a href="#jdbc_url">12.3. JDBC_URL</a></li>
</ul>
</li>
<li><a href="#instance-principal-authentication">13. Instance Principal authentication</a>
<ul class="sectlevel2">
<li><a href="#dynamic-group">13.1. Dynamic Group</a></li>
<li><a href="#dynamic-group-policy-statements">13.2. Dynamic Group Policy Statements</a></li>
</ul>
</li>
<li><a href="#start-the-application">14. Start the application</a></li>
<li><a href="#cleaning-up">15. Cleaning up</a></li>
<li><a href="#next-steps">16. Next steps</a></li>
</ul>

                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <h1>Securely store Micronaut Application secrets in Oracle Cloud Vault</h1>
                <div class="underline"></div>
<div class="sect1">
<div class="sectionbody">

<div class="paragraph">
<p>Learn how to create secrets in Oracle Cloud Vault and easily access them in a Micronaut application.</p>
</div>
<div class="paragraph">
<p>Authors: Burt Beckwith</p>
</div>
<div class="paragraph">
<p>Micronaut Version: 3.9.2</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started">1. Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, we will create a Micronaut application written in Kotlin.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-you-will-need">2. What you will need</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To complete this guide, you will need the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some time on your hands</p>
</li>
<li>
<p>A decent text editor or IDE</p>
</li>
<li>
<p>JDK 1.8 or greater installed with <code>JAVA_HOME</code> <a href="https://www.baeldung.com/java-home-on-windows-7-8-10-mac-os-x-linux">configured appropriately</a></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>An Oracle Cloud account (create a free trial account at <a href="https://signup.oraclecloud.com">signup.oraclecloud.com</a>)</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.cloud.oracle.com/en-us/iaas/Content/API/SDKDocs/cliinstall.htm">Oracle Cloud CLI</a> installed with local access to Oracle Cloud configured by running <code>oci setup config</code></p>
</li>
</ul>
</div>
</div>
</div>
</div></div><div class="row"><div class="col-md-12"><div class="sect1">
<h2 id="oracle-cloud-vault">3. Oracle Cloud Vault</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm">Oracle Cloud Vault</a> lets you securely store and retrieve secrets such as passwords or other information that shouldn&#8217;t be accessible in cleartext.</p>
</div>
<div class="paragraph">
<p>In this guide we&#8217;ll use Vault to store database connection information for a Micronaut application that uses MySQL, and use the Micronaut support for Oracle Cloud to make the process seamless.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-application">4. The Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Download the complete solution of the <a href="micronaut-data-jdbc-repository.html">Access a database with Micronaut Data JDBC</a> guide. You will use the sample application as a starting point.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-an-oracle-cloud-vault">5. Creating an Oracle Cloud Vault</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We&#8217;ll do the work of creating the vault with the Oracle Cloud CLI. See the <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/kms.html">Vault CLI command reference</a> for more information.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you prefer to use the Oracle Cloud web console to create the vault, follow the steps in the "Using Oracle Cloud Vault" section of the <a href="micronaut-oracle-autonomous-db.html">Access an Oracle Autonomous Database</a> guide.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some of the following commands use <a href="https://stedolan.github.io/jq/"><code>jq</code></a></p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>jq is a lightweight and flexible command-line JSON processor</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>There are three required parameters for the create command; compartment OCID, display name, and vault type.</p>
</div>
<div class="sect2">
<h3 id="compartment-ocid">5.1. Compartment OCID</h3>
<div class="paragraph">
<p>Find the <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/compartment/list.html">OCID of the compartment</a> where we&#8217;ll be deploying. Run this to list all the compartments in your root compartment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci iam compartment list</code></pre>
</div>
</div>
<div class="paragraph">
<p>and find the compartment by the name or description in the JSON output. It should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">compartment-id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.tenancy.oc1..aaaaaaaaud4g4e5ovjaw...</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">defined-tags</span><span class="delimiter">&quot;</span></span>: {},
  <span class="key"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Micronaut guides</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">freeform-tags</span><span class="delimiter">&quot;</span></span>: {},
  <span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">inactive-status</span><span class="delimiter">&quot;</span></span>: <span class="value">null</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">is-accessible</span><span class="delimiter">&quot;</span></span>: <span class="value">null</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">lifecycle-state</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ACTIVE</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">micronaut-guides</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">time-created</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2021-05-02T23:54:28.392000+00:00</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the OCID from the <code>id</code> property; the <code>compartment-id</code> property is the parent compartment.</p>
</div>
<div class="paragraph">
<p>For convenience, save the compartment OCID as an environment variable. For Linux or Mac, run</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">export C=ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...</code></pre>
</div>
</div>
<div class="paragraph">
<p>or for Windows, if using <code>cmd</code> run</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">set C=ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...</code></pre>
</div>
</div>
<div class="paragraph">
<p>and if using PowerShell run</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$C = &quot;ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...&quot;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the examples below we use Linux/Mac syntax for environment variables, e.g. <code>-c $C</code>. If you use Windows <code>cmd</code>, change those to <code>-c %C%</code> (but no change needed if using PowerShell)
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="create-the-vault">5.2. Create the Vault</h3>
<div class="paragraph">
<p>Choose a display name (1-100 characters) and a vault type, either <code>DEFAULT</code> or <code>VIRTUAL_PRIVATE</code>. We recommend that you choose <code>DEFAULT</code> to avoid the cost of a virtual private vault.</p>
</div>
<div class="paragraph">
<p>Run the <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/kms/management/vault/create.html">create command</a> with the compartment OCID, display name, and vault type substituted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci kms management vault create -c $C \
    --display-name mn_guide_vault \
    --vault-type DEFAULT \
    | jq -r '.data.id'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>jq</code> utility will extract the vault OCID from the <code>id</code> property in the response; this is the unique identifier for your vault which you&#8217;ll need later. Store the value as the <code>VAULT_ID</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>export VAULT_ID=ocid1.vault.oc1.iad.b5re3....abuwcljryp5dmxbu3si7...</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you use Linux or Mac, you can combine both commands into one, creating the vault and setting the environment variable at the same time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">export VAULT_ID=$(oci kms management vault create -c $C \
    --display-name mn_guide_vault \
    --vault-type DEFAULT \
    | jq -r '.data.id')</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="create-a-master-encryption-key">5.2.1. Create a Master Encryption Key</h4>
<div class="paragraph">
<p>Next we need to <a href="https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm">create a Master Encryption Key</a>.</p>
</div>
<div class="paragraph">
<p>For this we need the management endpoint URL that wasn&#8217;t available yet in the response from the vault <code>create</code> command. Run the <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/kms/management/vault/get.html">get command</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci kms management vault get --vault-id $VAULT_ID</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">data</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">compartment-id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.tenancy.oc1..aaaaaaaaixksuiqo3rx6...</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">crypto-endpoint</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://b5re3...-crypto.kms.us-ashburn-1.oraclecloud.com</span><span class="delimiter">&quot;</span></span>,
    <span class="error">.</span><span class="error">.</span><span class="error">.</span>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">display-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">mn_guide_vault</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.vault.oc1.iad.b5re3....abuwcljryp5dmxbu3si7...</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">is-primary</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">lifecycle-state</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ACTIVE</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">management-endpoint</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://b5re3...-management.kms.us-ashburn-1.oraclecloud.com</span><span class="delimiter">&quot;</span></span>,
    <span class="error">.</span><span class="error">.</span><span class="error">.</span>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It will take a few minutes for the vault to finish provisioning. Re-run the <code>get</code> command until the value of <code>lifecycle-state</code> is <code>ACTIVE</code>. The URL is available in the <code>management-endpoint</code> property.</p>
</div>
<div class="paragraph">
<p>Store the URL as the <code>VAULT_ENDPOINT</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>export VAULT_ENDPOINT=https://b5re3...-management.kms.us-ashburn-1.oraclecloud.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>Choose a name for the key, e.g., "mn-guide-encryption-key", and a "Protection Mode", either <code>SOFTWARE</code> or <code>HSM</code>. We recommend that you choose <code>SOFTWARE</code> to avoid the cost of using a hardware security module (HSM). You also need to decide on a key shape algorithm and key length; for this guide we&#8217;ll use <code>AES</code> and a key length of 32 (256 bits).</p>
</div>
<div class="paragraph">
<p>Run the <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/kms/management/key/create.html">create command</a> with the compartment OCID, display name, protection mode, key shape, and management endpoint substituted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci kms management key create -c $C \
    --display-name mn-guide-encryption-key \
    --protection-mode SOFTWARE \
    --key-shape '{&quot;algorithm&quot;:&quot;AES&quot;,&quot;length&quot;:&quot;32&quot;}' \
    --endpoint $VAULT_ENDPOINT
    | jq -r '.data.id'</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you use Windows, escape the inner double quotes in the value for <code>key-shape</code>: <code>'{\"algorithm\":\"AES\",\"length\":\"32\"}</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>jq</code> utility will extract the <code>id</code> value from the response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ocid1.key.oc1.iad.b5re3.....abuwcljrcuie7t6gctc6...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Store the key ID as the <code>VAULT_KEY_ID</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>export VAULT_KEY_ID=ocid1.key.oc1.iad.b5re3.....abuwcljrcuie7t6gctc6...</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-vault-with-micronaut">6. Using Vault with Micronaut</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="micronaut-oraclecloud-vault-dependency">6.1. micronaut-oraclecloud-vault Dependency</h3>
<div class="paragraph">
<p>The <a href="https://micronaut-projects.github.io/micronaut-oracle-cloud/latest/guide/#vault">micronaut-oracle-cloud</a> subproject provides integration between Micronaut apps and Oracle Cloud, including using Vault as a distributed configuration source. Add a dependency to your build for the <code>micronaut-oraclecloud-vault</code> library to add Vault support:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">implementation(<span class="string"><span class="delimiter">&quot;</span><span class="content">io.micronaut.oraclecloud:micronaut-oraclecloud-vault</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="distributed-configuration">7. Distributed Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="enable-distributed-configuration">7.1. Enable Distributed Configuration</h3>
<div class="paragraph">
<p>Create a <code>bootstrap.yml</code> file in the <code>resources</code> directory to <a href="https://docs.micronaut.io/latest/guide/#bootstrap">enable distributed configuration</a>.
Add the following:</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/bootstrap.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">application</span>:
    <span class="key">name</span>: <span class="string"><span class="content">micronautguide </span></span><i class="conum" data-value="1"></i><b>(1)</b>
  <span class="key">config-client</span>:
    <span class="key">enabled</span>: <span class="string"><span class="content">true </span></span><i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set the application name in <code>bootstrap.yml</code> instead of <code>application.yml</code> so that it is available when reading configuration from distributed sources.
properties</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set <code>microanut.config-client.enabled: true</code> which is used to read and resolve configuration from distributed sources.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="clean-up-application-configuration">7.2. Clean up Application Configuration</h3>
<div class="paragraph">
<p>If <code>application.yml</code> sets <code>micronaut.application.name</code>, remove it. You moved it to <code>bootstrap.yml</code>.</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="diff"><span class="line delete"><span class="delete">-</span> micronaut:</span>
<span class="line delete"><span class="delete">-</span>  application:</span>
<span class="line delete"><span class="delete">-</span>    name: micronautguide</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="disable-distributed-configuration-for-test">7.3. Disable Distributed Configuration for Test</h3>
<div class="paragraph">
<p>To disable distributed configuration for tests, create a <code>bootstrap-test.yml</code> file:</p>
</div>
<div class="listingblock">
<div class="title">src/test/resources/bootstrap-test.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">config-client</span>:
    <span class="key">enabled</span>: <span class="string"><span class="content">false</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-changes">8. Configuration changes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="bootstrap-oraclecloud-yml">8.1. bootstrap-oraclecloud.yml</h3>
<div class="paragraph">
<p>Then create <code>src/main/resources/bootstrap-oraclecloud.yml</code> with the following content:</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/bootstrap-oraclecloud.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">oci</span>:
  <span class="key">config</span>:
    <span class="key">instance-principal</span>:
      <span class="key">enabled</span>: <span class="string"><span class="content">true </span></span><i class="conum" data-value="1"></i><b>(1)</b>
  <span class="key">vault</span>:
    <span class="key">config</span>:
      <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">vaults</span>:
      - <span class="string"><span class="content">ocid: ${VAULT_ID} </span></span><i class="conum" data-value="2"></i><b>(2)</b>
        <span class="key">compartment-ocid</span>: <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We&#8217;ll use <a href="https://micronaut-projects.github.io/micronaut-oracle-cloud/latest/guide/#instance-principals">Instance Principal authentication</a> to allow the Micronaut application to access Vault</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set the value of the <code>ocid</code> property with the vault OCID unique identifier you saved when creating the vault.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set the value of the <code>compartment-ocid</code> property with the OCID unique identifier of the compartment where you created the vault and secrets</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mysql-database">9. MySQL Database</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the <a href="micronaut-cloud-database-oracle.html">Deploy a Micronaut MySQL Database Application to Oracle Cloud</a> guide to create a MySQL database; follow the steps in the "Creating a MySQL DB System at Oracle Cloud" section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-the-application">10. Deploying the Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the <a href="micronaut-oracle-cloud.html">Deploy a Micronaut application to Oracle Cloud</a> guide to create a compute instance and deploy the application to it; follow the steps in the "Create an Oracle Cloud Compute Instance" and "Deploy to Oracle Cloud" sections up to the step where you start the application. We need to connect the application to the MySQL database before starting it up.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When creating the compute VM at Oracle Cloud, use the same subnet as the one where you created the MySQL database, otherwise the application will not be able to access the database.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-mysql-access">11. Configuring MySQL Access</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the <a href="micronaut-cloud-database-oracle.html">Deploy a Micronaut MySQL Database Application to Oracle Cloud</a> guide to configure access to the MySQL database; follow the steps in the "Configure MySQL" section. You will need the private IP address of the VM, the MySQL private IP address, and the admin username and password you chose when creating the database.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-secrets">12. Creating Secrets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the <a href="micronaut-data-jdbc-repository.html">Access a database with Micronaut Data JDBC</a> guide, the values for the JDBC URL, database username and password, and the JDBC driver class are "externalized" properties with default values:</p>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">datasources</span>:
  <span class="key">default</span>:
    <span class="key">url</span>: <span class="string"><span class="content">${JDBC_URL:`jdbc:mysql://localhost:3306/db`}</span></span>
    <span class="key">username</span>: <span class="string"><span class="content">${JDBC_USER:root}</span></span>
    <span class="key">password</span>: <span class="string"><span class="content">${JDBC_PASSWORD:}</span></span>
    <span class="key">dialect</span>: <span class="string"><span class="content">MYSQL</span></span>
    <span class="key">driverClassName</span>: <span class="string"><span class="content">${JDBC_DRIVER:com.mysql.cj.jdbc.Driver}</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The guide recommends that you set environment variables to override the default values, but in this guide we&#8217;ll go a step further and store some of those values in our Oracle Cloud Vault. We&#8217;ll leave the default for the driver class, but create vault secrets for <code>JDBC_USER</code>, <code>JDBC_PASSWORD</code>, and <code>JDBC_URL</code>.</p>
</div>
<div class="sect2">
<h3 id="jdbc_user">12.1. JDBC_USER</h3>
<div class="paragraph">
<p>The first secret will be for the database username, so the secret name will be <code>JDBC_USER</code>.</p>
</div>
<div class="paragraph">
<p>Secret values must be Base64-encoded. You can encode the value programmatically, e.g., <code>Base64.getEncoder().encodeToString("the value".getBytes())</code>, or use an online tool such as <a href="https://www.base64encode.org/" class="bare">https://www.base64encode.org/</a>.</p>
</div>
<div class="paragraph">
<p>Run the <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/vault/secret/create-base64.html">create-base64 command</a> with the compartment OCID, encryption key OCID, vault OCID, secret name, and Base64-encoded secret value substituted. If you use <code>guide_user</code> as the username, the Base64-encoded value will be <code>Z3VpZGVfdXNlcg==</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci vault secret create-base64 -c $C \
    --key-id $VAULT_KEY_ID \
    --vault-id $VAULT_ID \
    --secret-name JDBC_USER \
    --secret-content-content Z3VpZGVfdXNlcg==</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that running that command will leave the Base64-encoded value in your shell history. To avoid this, you can create a JSON file containing the parameters and pass that as an argument to the command.</p>
</div>
<div class="paragraph">
<p>To use this approach, create a file like this with values substituted, and save it as key.json:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
   <span class="key"><span class="delimiter">&quot;</span><span class="content">compartmentId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...</span><span class="delimiter">&quot;</span></span>,
   <span class="key"><span class="delimiter">&quot;</span><span class="content">keyId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.key.oc1.iad.b5re3.....abuwcljrcuie7t6gctc6...</span><span class="delimiter">&quot;</span></span>,
   <span class="key"><span class="delimiter">&quot;</span><span class="content">vaultId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.vault.oc1.iad.b5re3....abuwcljryp5dmxbu3si7...</span><span class="delimiter">&quot;</span></span>,
   <span class="key"><span class="delimiter">&quot;</span><span class="content">secretName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">JDBC_USER</span><span class="delimiter">&quot;</span></span>,
   <span class="key"><span class="delimiter">&quot;</span><span class="content">secretContentContent</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Z3VpZGVfdXNlcg==</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and run this <code>create-base64</code> command instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci vault secret create-base64 --from-json file://key.json</code></pre>
</div>
</div>
<div class="paragraph">
<p>With either approach the response should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">data</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">compartment-id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...</span><span class="delimiter">&quot;</span></span>,
    <span class="error">.</span><span class="error">.</span><span class="error">.</span>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.vaultsecret.oc1.iad.amaaaaaafzr7royabqgz...</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">key-id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.key.oc1.iad.b5re3.....abuwcljrcuie7t6gctc6...</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">lifecycle-state</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">CREATING</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">secret-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">JDBC_USER</span><span class="delimiter">&quot;</span></span>,
    <span class="error">.</span><span class="error">.</span><span class="error">.</span>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">vault-id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ocid1.vault.oc1.iad.b5re3....abuwcljryp5dmxbu3si7...</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jdbc_password">12.2. JDBC_PASSWORD</h3>
<div class="paragraph">
<p>Create a second secret with the name <code>JDBC_PASSWORD</code>. The value will be the Base64-encoded database user password you chose earlier.</p>
</div>
</div>
<div class="sect2">
<h3 id="jdbc_url">12.3. JDBC_URL</h3>
<div class="paragraph">
<p>Create a third secret with the name <code>JDBC_URL</code>. The URL will be <code>jdbc:mysql://&lt;MySQL IP address&gt;:3306/micronaut</code> with the private IP address of your MySQL database substituted. Set the value of the secret as the Base64-encoded URL value.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="instance-principal-authentication">13. Instance Principal authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We&#8217;ll use <a href="https://micronaut-projects.github.io/micronaut-oracle-cloud/latest/guide/#instance-principals">Instance Principal authentication</a> to allow the Micronaut application to retrieve secrets from Vault. To use this, we need to create a dynamic group and add a policy statement granting permission.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you prefer to use the Oracle Cloud web console to create the dynamic group and policy statements, follow the steps in the "Instance Principal authentication" section of the <a href="micronaut-oracle-cloud-streaming.html">Oracle Cloud Streaming and the Micronaut Framework - Event-Driven Applications at Scale</a> guide.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="dynamic-group">13.1. Dynamic Group</h3>
<div class="paragraph">
<p>Choose a group name, e.g., "mn-guide-dg", and a matching rule, i.e., the logic that will be used to determine group membership. We&#8217;ll make the rule fairly broad - use <code>ALL {instance.compartment.id = 'ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm&#8230;&#8203;'}</code> replacing <code>ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm&#8230;&#8203;</code> with the compartment OCID:</p>
</div>
<div class="paragraph">
<p>Run the <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/dynamic-group/create.html">create command</a> with the compartment OCID substituted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci iam dynamic-group create \
   --name mn-guide-dg \
   --description mn-guide-dg \
   --matching-rule &quot;ALL {instance.compartment.id = 'ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...'}&quot; \
   | jq -r '.data.&quot;compartment-id&quot;'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>jq</code> utility will extract the <code>compartment-id</code> value from the response. Store the ID (the tenancy ID) as the <code>T</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>export T=ocid1.tenancy.oc1..aaaaaaaaud4g4e5ovjaw...</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingdynamicgroups.htm">Dynamic Group docs</a> for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="dynamic-group-policy-statements">13.2. Dynamic Group Policy Statements</h3>
<div class="paragraph">
<p>Next, create the policy granting read access to Vault.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll create the policy in the root compartment, i.e., the tenancy, so we&#8217;ll use the tenancy OCID saved from the dynamic group creation response.</p>
</div>
<div class="paragraph">
<p>Run the <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/policy/create.html">create command</a> with the tenancy OCID substituted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci iam policy create -c $T \
    --name mn-guide-policy \
    --description mn-guide-policy \
    --statements '[&quot;allow dynamic-group mn-guide-dg to read secret-family in tenancy&quot;]' \
    | jq -r '.data.id'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>jq</code> utility will extract the policy OCID from the <code>id</code> property in the response. Store the value as the <code>POLICY_ID</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>export POLICY_ID=ocid1.policy.oc1..aaaaaaaau7uhwxr3ynlr...</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="start-the-application">14. Start the application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Finally, start the application. From the SSH session into your VM, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">java -jar application.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify that the application is working correctly with some cURL commands.</p>
</div>
<div class="paragraph">
<p>Create a genre by running</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl -X POST http://[VM IP Address]:8080/genres \
     -H 'Content-Type: application/json; charset=utf-8' \
     -d $'{ &quot;name&quot;: &quot;music&quot; }'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">music</span><span class="delimiter">&quot;</span></span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>List all genres by running</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl http://[VM IP Address]:8080/genres/list</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[{<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">music</span><span class="delimiter">&quot;</span></span>}]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cleaning-up">15. Cleaning up</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you&#8217;ve finished this guide, you can clean up the resources you created.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/policy/delete.html">Delete the policy</a> by running</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci iam policy delete --policy-id $POLICY_ID</code></pre>
</div>
</div>
<div class="paragraph">
<p>To delete the dynamic group, find its OCID by running the <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/dynamic-group/list.html">list command</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci iam dynamic-group list | jq -r '.data[] | select(.name==&quot;mn-guide-dg&quot;) | .id'</code></pre>
</div>
</div>
<div class="paragraph">
<p>and run the <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/dynamic-group/delete.html">delete command</a>, substituting the group OCID:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci iam dynamic-group delete --dynamic-group-id ocid1.dynamicgroup.oc1..aaaaaaaaipoabhhaqnj77urm...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, delete the vault. You cannot delete it directly; instead you can <a href="https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/kms/management/vault/schedule-deletion.html">request deletion</a> at a date at least seven days in the future. Run this, replacing the date with one seven days (or more) from now:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">oci kms management vault schedule-deletion \
    --vault-id $VAULT_ID \
    --time-of-deletion 2022-05-12</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="next-steps">16. Next steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Explore more features with <a href="https://micronaut.io/guides/">Micronaut Guides</a>.</p>
</div>
<div class="paragraph">
<p>Read more about the <a href="https://micronaut-projects.github.io/micronaut-oracle-cloud/latest/guide/">Micronaut Oracle Cloud</a> integration.</p>
</div>

            </div>
        </div>
    </div>
</main>

<footer id="footer">
    <div class="container">

        <div class="row">
            <div class="col-sm-5 footer-left">

                <div id="text-14" class="widget widget_text">
                    <div class="textwidget">
                        <p>
                            <img class="alignnone size-medium wp-image-3736" src="./images/micronaut_foundation_horizontal_white.svg" alt="Micronaut Foundation"/>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-sm-7 footer-right">

                <ul class="meta">

                    <li id="menu-item-2895" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2895">
                        <a href="https://micronaut.io/brand-guidelines/">Brand Guidelines</a>
                    </li>
                    <li id="menu-item-2894" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2894">
                        <a href="https://micronaut.io/community-guidelines/">Community Guidelines</a>
                    </li>
                    <li id="menu-item-3377" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-3377">
                        <a href="https://micronaut.io/privacy-policy/">Privacy Policy</a>
                    </li>

                </ul>

                <div id="nav_menu-2" class="widget widget_nav_menu">
                    <div class="menu-links-container">
                        <ul id="menu-links" class="menu">
                            <li class="menu-item menu-item-type-custom menu-item-object-custom "><a href="https://micronautpodcast.com"><i class="fa fa-podcast"><span class="sr-only">Podcast</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom "><a href="https://micronaut.io/feed/rss/"><i class="fa fa-feed"><span class="sr-only">Feed</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom "><a href="mailto:info@micronaut.io"><i class="fas fa-envelope"><span class="sr-only">Mail</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://twitter.com/micronautfw"><i class="fab fa-twitter"><span class="sr-only">Twitter</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://matrix.to/#/#micronautfw_questions:gitter.im"><i class="fab fa-gitter"><span class="sr-only">Gitter</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://github.com/micronaut-projects/"><i class="fab fa-github"><span class="sr-only">GitHub</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.youtube.com/@MicronautFramework"><i class="fab fa-youtube"><span class="sr-only">YouTube</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.linkedin.com/showcase/micronaut"><i class="fab fa-linkedin"><span class="sr-only">LinkedIn</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.twitch.tv/micronautfw"><i class="fab fa-twitch"><span class="sr-only">Twitch</span></i></a></li>
                        </ul>
                    </div>
                </div>
                <div id="text-5" class="widget widget_text">
                    <div class="textwidget">
                        <p>
                            <small>© 2023 MICRONAUT FOUNDATION. ALL RIGHTS RESERVED</small>
                        </p>
                    </div>
                </div>

            </div>
        </div>
    </div>
</footer>
</body>
</html>
