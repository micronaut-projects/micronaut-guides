<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1'/>
    <title>RabbitMQ RPC and the Micronaut Framework</title>
    <link rel='stylesheet' id='wp-block-library-css' href='https://micronaut.io/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all'/>
    <link rel='stylesheet' id='fonts-fira-sans-css' href='https://fonts.googleapis.com/css2?family=Fira+Sans%3Awght%40300%3B500&#038;display=swap&#038;ver=5.7' type='text/css' media='all'/>
    <link rel='stylesheet' id='micronaut-style-css' href='https://micronaut.io/wp-content/themes/micronaut/style.min.css' type='text/css' media='all'/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="icon" href="https://micronaut.io/wp-content/uploads/2021/02/favicon.ico" type="image/png">
    <link rel="shortcut icon" href="https://micronaut.io/wp-content/uploads/2021/02/favicon.ico" type="image/png">
    <link rel="alternate" type="application/rss+xml" title="Micronaut Guides RSS Feed" href="https://guides.micronaut.io/latest/rss.xml" />
    <link rel="alternate" type="application/json" title="Micronaut Guides JSON Feed" href="https://guides.micronaut.io/latest/feed.json" />
    <link href="coderay.css" rel="stylesheet" />
    <link href="guide.css" rel="stylesheet" />
    <script src="lunr.js"></script>
    <script src="guide.js"></script>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image" content="https://guides.micronaut.io/latest/images/cards/micronaut-rabbitmq-rpc.png"/>
    <meta name="twitter:creator" content="@micronautfw"/>
    <meta name="twitter:site" content="@micronautfw"/>
    <meta name="twitter:title" content="RabbitMQ RPC and the Micronaut Framework"/>
    <meta name="twitter:description" content="Use RabbitMQ RPC to use request-reply pattern in your Micronaut applications."/>
</head>
<body class="page-template page-template-page-sidebar page-template-page-sidebar-php page page-parent guide">

<header id="header">

    <div class="container">

        <nav class="navbar navbar-expand-lg navbar-dark">

            <button class="collapsed" type="button" data-toggle="collapse" data-target="#nav" aria-expanded="false">
                <span></span>
            </button>

            <a class="navbar-brand" href="https://micronaut.io">
                <img src="https://micronaut.io/wp-content/uploads/2020/11/MIcronautLogo_Horizontal.svg" alt="Micronaut framework"/>
            </a>

            <div class="collapse navbar-collapse" id="nav">

                <ul class="navbar-nav ml-auto">

                    <li id="menu-item-2865" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2865 nav-item"><a href="https://micronaut.io/download/" class="nav-link">Download</a></li>
                    <li id="menu-item-2868" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-2868 dropdown nav-item"><a href="https://micronaut.io/learn/" class="nav-link dropdown-toggle" data-toggle="dropdown">Learn</a><ul class="dropdown-menu">
                        <li id="menu-item-4943" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4943"><a href="https://micronaut.io/learn/" class="dropdown-item">Overview</a></li>
                        <li id="menu-item-5111" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5111"><a href="https://docs.micronaut.io/index.html" class="dropdown-item">User Documentaton</a></li>
                        <li id="menu-item-4510" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4510"><a href="https://micronaut.io/guides/" class="dropdown-item">Guides</a></li>
                        <li id="menu-item-2896" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2896"><a href="https://micronaut.io/category/microcast/" class="dropdown-item">Microcasts</a></li>
                        <li id="menu-item-2897" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2897"><a href="https://micronaut.io/category/webinar/" class="dropdown-item">Webinars</a></li>
                        <li id="menu-item-2871" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2871"><a href="https://micronaut.io/professional-training/" class="dropdown-item">Professional Training</a></li>
                        <li id="menu-item-6526" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6526"><a href="https://micronaut-projects.github.io/micronaut-guides-mn3/latest/" class="dropdown-item">Guides for Micronaut Framework 3</a></li>
                    </ul>
                    </li>
                    <li id="menu-item-2878" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2878 dropdown nav-item"><a href="https://micronaut.io/resources/" class="nav-link dropdown-toggle" data-toggle="dropdown">Resources</a><ul class="dropdown-menu">
                        <li id="menu-item-4999" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4999"><a href="https://micronaut.io/upcoming-events/" class="dropdown-item">Upcoming Events</a></li>
                        <li id="menu-item-2879" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2879"><a href="https://micronaut.io/blog/" class="dropdown-item">Blog</a></li>
                        <li id="menu-item-6478" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6478"><a href="https://micronaut.io/category/release-announcements/" class="dropdown-item">Releases</a></li>
                        <li id="menu-item-6715" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6715"><a href="https://micronaut.io/category/security-announcements/" class="dropdown-item">Security Announcements</a></li>
                        <li id="menu-item-4499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4499"><a href="https://micronautpodcast.com/" class="dropdown-item">Podcast</a></li>
                        <li id="menu-item-5798" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5798"><a href="https://micronaut.io/support/" class="dropdown-item">Commercial Support</a></li>
                        <li id="menu-item-4186" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4186"><a href="https://micronaut.io/resources/community-support/" class="dropdown-item">Community Support</a></li>
                        <li id="menu-item-2882" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2882"><a href="https://micronaut.io/faq/" class="dropdown-item">FAQ</a></li>
                        <li id="menu-item-2883" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2883"><a href="https://micronaut.io/contact/" class="dropdown-item">Contact</a></li>
                        <li id="menu-item-6479" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6479"><a href="https://micronaut.io/micronaut-success-stories/" class="dropdown-item">Micronaut Success Stories</a></li>
                    </ul>
                    </li>
                    <li id="menu-item-2872" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2872 dropdown nav-item"><a href="https://micronaut.io/foundation/" class="nav-link dropdown-toggle" data-toggle="dropdown">Foundation</a><ul class="dropdown-menu">
                        <li id="menu-item-2877" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2877"><a href="https://micronaut.io/foundation/" class="dropdown-item">Overview</a></li>
                        <li id="menu-item-2874" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2874"><a href="https://micronaut.io/foundation/corporate-sponsorship/" class="dropdown-item">Corporate Sponsorship</a></li>
                        <li id="menu-item-2873" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2873"><a href="https://micronaut.io/foundation/community-sponsorship/" class="dropdown-item">Community Sponsorship</a></li>
                        <li id="menu-item-2876" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2876"><a href="https://micronaut.io/foundation/sponsors/" class="dropdown-item">Sponsors</a></li>
                        <li id="menu-item-3838" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3838"><a href="https://micronaut.io/meeting-minutes/" class="dropdown-item">Meeting Minutes</a></li>
                    </ul>
                    </li>
                    <li id="menu-item-2884" class="action menu-item menu-item-type-custom menu-item-object-custom menu-item-2884 nav-item"><a target="_blank" rel="noopener" href="https://micronaut.io/launch/" class="nav-link">Launch</a></li>

                </ul>

            </div>

        </nav>

    </div>
</header>

<div style="background: #fff;padding-top: 20px;padding-bottom: 20px;">
    <div class="container" style="clear: both;">
        <fieldset style="float: right;">
            <input type="search" id="search-form-query"/>
            <input type="submit" onclick="search()" value="Search">
            <input type="submit" onclick="resetSearch()" value="Reset">
        </fieldset>
    </div>
    <div class="container" style="clear: both;margin-top: -20px;">
        <div class="guide-list" id="searchResults">
        </div>
    </div>
</div>
<div id="breadcrumbs"><div class="container"><a href="https://micronaut.io/">Home</a> » <a href="./index.html">Guides</a> » <a href="micronaut-rabbitmq-rpc.html">RabbitMQ RPC and the Micronaut Framework</a> » <span class="breadcrumb_last" aria-current="page">maven | groovy</span></div></div><!-- .breadcrumbs -->
<main id="main">
    <div class="container">
        <div class="row">
            <div class="col-md-4">

                <div class="toc">
                    <div class="inner">
                        <h1 class="title title_large first-word-bold first-word-break">Table of Contents</h1>
                        <div class="underline"></div>
                        
<ul class="sectlevel1">
<li><a href="#getting-started">1. Getting Started</a></li>
<li><a href="#what-you-will-need">2. What you will need</a></li>
<li><a href="#solution">3. Solution</a></li>
<li><a href="#writing-the-application">4. Writing the Application</a></li>
<li><a href="#test-resources">5. Test Resources</a>
<ul class="sectlevel2">
<li><a href="#catalogue-microservice">5.1. Catalogue microservice</a></li>
<li><a href="#inventory-microservice">5.2. Inventory microservice</a></li>
<li><a href="#recommendation-microservice">5.3. Recommendation microservice</a></li>
</ul>
</li>
<li><a href="#rabbitmq-and-the-micronaut-framework">6. RabbitMQ and the Micronaut Framework</a>
<ul class="sectlevel2">
<li><a href="#install-rabbitmq-via-docker">6.1. Install RabbitMQ via Docker</a></li>
<li><a href="#alternative-methods">6.2. Alternative methods</a></li>
</ul>
</li>
<li><a href="#running-the-application">7. Running the Application</a></li>
<li><a href="#next-steps">8. Next Steps</a></li>
<li><a href="#license">9. License</a></li>
</ul>

                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <h1>RabbitMQ RPC and the Micronaut Framework</h1>
                <div class="underline"></div>
<div class="sect1">
<div class="sectionbody">

<div class="paragraph">
<p>Use RabbitMQ RPC to use request-reply pattern in your Micronaut applications.</p>
</div>
<div class="paragraph">
<p>Authors: Iván López</p>
</div>
<div class="paragraph">
<p>Micronaut Version: 4.9.1</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started">1. Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, we will create three microservices that will communicate with each other with <a href="https://www.rabbitmq.com/">RabbitMQ</a> using the request-response pattern with <a href="https://micronaut-projects.github.io/micronaut-rabbitmq/latest/guide/#rpc">RPC</a>
<em>(Remote Procedure Call)</em>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>RabbitMQ is an open-source message-broker software that originally implemented the Advanced Message Queuing Protocol (AMQP)
and has since been extended with a plug-in architecture to support Streaming Text Oriented Messaging Protocol (STOMP),
Message Queuing Telemetry Transport (MQTT), and other protocols.</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-you-will-need">2. What you will need</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To complete this guide, you will need the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some time on your hands</p>
</li>
<li>
<p>A decent text editor or IDE (e.g. <a href="https://guides.micronaut.io/latest/micronaut-intellij-idea-ide-setup.html">IntelliJ IDEA</a>)</p>
</li>
<li>
<p>JDK 21 or greater installed with <code>JAVA_HOME</code> <a href="https://www.baeldung.com/java-home-on-windows-7-8-10-mac-os-x-linux">configured appropriately</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div><div class="row"><div class="col-md-12"><div class="sect1">
<h2 id="solution">3. Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We recommend that you follow the instructions in the next sections and create the application step by step. However, you can go right to the <strong>completed example</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="micronaut-rabbitmq-rpc-maven-groovy.zip">Download</a> and unzip the source</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-the-application">4. Writing the Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s describe the microservices you will build through the guide.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bookcatalogue</code> - This returns a list of books. It uses a domain consisting of a book name and an ISBN.</p>
</li>
<li>
<p><code>bookinventory</code> - This exposes an endpoint to check whether a book has sufficient stock to fulfill an order. It uses a domain consisting of a stock level and an ISBN.</p>
</li>
<li>
<p><code>bookrecommendation</code> - This consumes previous services and exposes an endpoint that recommends book names that are in stock.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://guides.micronaut.io/latest/micronaut-intellij-idea-ide-setup.html">Setup IntelliJ IDEA to develop Micronaut Applications</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-resources">5. Test Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the application is started locally&#8201;&#8212;&#8201;either under test or by <a href="#running-the-application">running the application</a>&#8201;&#8212;&#8201;resolution of the <code>rabbitmq.uri</code> property is detected and the Test Resources service will start a local RabbitMQ docker container, and inject the properties required to use this as the message broker.</p>
</div>
<div class="paragraph">
<p>When running under production, you should replace this property with the location of your production message broker via an environment variable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">RABBITMQ_URI=amqp://production-server:5672</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see the <a href="https://micronaut-projects.github.io/micronaut-test-resources/snapshot/guide/#modules-rabbitmq">RabbitMQ section of the Test Resources documentation</a>.</p>
</div>
<div class="sect2">
<h3 id="catalogue-microservice">5.1. Catalogue microservice</h3>
<div class="paragraph">
<p>Create the <code>bookcatalogue</code> microservice using the <a href="https://docs.micronaut.io/latest/guide/#cli">Micronaut Command Line Interface</a> or with <a href="https://launch.micronaut.io">Micronaut Launch</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mn create-app --features=rabbitmq,graalvm example.micronaut.bookcatalogue --build=maven --lang=groovy</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you don&#8217;t specify the <code>--build</code> argument, Gradle with the <a href="https://docs.gradle.org/current/userguide/kotlin_dsl.html">Kotlin DSL</a> is used as the build tool. <br/> If you don&#8217;t specify the <code>--lang</code> argument, Java is used as the language.<br/> If you don&#8217;t specify the <code>--test</code> argument, JUnit is used for Java and Kotlin, and Spock is used for Groovy.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you use Micronaut Launch, select Micronaut Application as application type and add the <code>rabbitmq</code> and <code>graalvm</code> features.</p>
</div>
<div class="paragraph">
<p>The previous command creates a directory named <code>bookcatalogue</code> and a Micronaut application inside it with default package <code>example.micronaut</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you have an existing Micronaut application and want to add the functionality described here, you can view the dependency and configuration changes from the specified features, and apply those changes to your application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://micronaut.io/launch?features=yaml&amp;features=rabbitmq&amp;features=serialization-jackson&amp;lang=GROOVY&amp;build=MAVEN&amp;test=SPOCK&amp;name=bookcatalogue&amp;type=DEFAULT&amp;package=example.micronaut&amp;activity=diff" target="_blank" rel="noopener">Diff</a></p>
</div>
<div class="sect3">
<h4 id="create-rabbitmq-exchange-queue-and-binding">5.1.1. Create RabbitMQ exchange, queue, and binding</h4>
<div class="paragraph">
<p>Before being able to send and receive messages using RabbitMQ, it is necessary to define the exchange, queue, and binding.
One option is to create them directly in the RabbitMQ Admin UI available on <a href="http://localhost:15672" class="bare">http://localhost:15672</a>.
Use <code>guest</code> for both username and password.</p>
</div>
<div class="paragraph">
<p>Another option is to create them programmatically. Create the class <code>ChannelPoolListener.java</code>:</p>
</div>
<div class="listingblock">
<div class="title">bookcatalogue/src/main/groovy/example/micronaut/ChannelPoolListener.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example.micronaut

<span class="keyword">import</span> <span class="include">com.rabbitmq.client.BuiltinExchangeType</span>
<span class="keyword">import</span> <span class="include">com.rabbitmq.client.Channel</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.connect.ChannelInitializer</span>
<span class="keyword">import</span> <span class="include">jakarta.inject.Singleton</span>

<span class="annotation">@Singleton</span>
<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">ChannelPoolListener</span> <span class="directive">extends</span> ChannelInitializer {

    <span class="annotation">@Override</span>
    <span class="type">void</span> initialize(<span class="predefined-type">Channel</span> channel, <span class="predefined-type">String</span> name) <span class="directive">throws</span> <span class="exception">IOException</span> {
        channel.exchangeDeclare(<span class="string"><span class="delimiter">'</span><span class="content">micronaut</span><span class="delimiter">'</span></span>, BuiltinExchangeType.DIRECT, <span class="predefined-constant">true</span>) <i class="conum" data-value="1"></i><b>(1)</b>

        channel.queueDeclare(<span class="string"><span class="delimiter">'</span><span class="content">inventory</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>, <span class="predefined-constant">false</span>, <span class="predefined-constant">false</span>, <span class="predefined-constant">null</span>) <i class="conum" data-value="2"></i><b>(2)</b>
        channel.queueBind(<span class="string"><span class="delimiter">'</span><span class="content">inventory</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">micronaut</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">books.inventory</span><span class="delimiter">'</span></span>) <i class="conum" data-value="3"></i><b>(3)</b>

        channel.queueDeclare(<span class="string"><span class="delimiter">'</span><span class="content">catalogue</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>, <span class="predefined-constant">false</span>, <span class="predefined-constant">false</span>, <span class="predefined-constant">null</span>) <i class="conum" data-value="4"></i><b>(4)</b>
        channel.queueBind(<span class="string"><span class="delimiter">'</span><span class="content">catalogue</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">micronaut</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">books.catalogue</span><span class="delimiter">'</span></span>) <i class="conum" data-value="5"></i><b>(5)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Define an exchange named <code>micronaut</code>. From the producer point of view, everything is sent to the exchange with the
appropriate routing key.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define a queue named <code>inventory</code>. The consumer will listen for messages in that queue.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define a binding between the exchange and the queue using the routing key <code>books.inventory</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Define a queue named <code>catalogue</code>. The consumer will listen for messages in that queue.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Define a binding between the exchange and the queue using the routing key <code>books.catalogue</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this Catalogue Microservice, the only necessary element is the <code>catalogue</code> queue, but it is a good practice to define
all the elements in the same file and share the file between all the projects.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="create-consumer">5.1.2. Create consumer</h4>
<div class="paragraph">
<p>Create a <code>BookCatalogueService</code> class to handle incoming RPC requests into the <code>bookcatalogue</code> microservice:</p>
</div>
<div class="listingblock">
<div class="title">bookcatalogue/src/main/groovy/example/micronaut/BookCatalogueService.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example.micronaut

<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.annotation.Queue</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.annotation.RabbitListener</span>

<span class="annotation">@CompileStatic</span>
<span class="annotation">@RabbitListener</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="type">class</span> <span class="class">BookCatalogueService</span> {

    <span class="annotation">@Queue</span>(<span class="string"><span class="delimiter">'</span><span class="content">catalogue</span><span class="delimiter">'</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; listBooks() {
        <span class="predefined-type">Book</span> buildingMicroservices = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="string"><span class="delimiter">'</span><span class="content">1491950358</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Building Microservices</span><span class="delimiter">'</span></span>)
        <span class="predefined-type">Book</span> releaseIt = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="string"><span class="delimiter">'</span><span class="content">1680502395</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Release It!</span><span class="delimiter">'</span></span>)
        <span class="predefined-type">Book</span> cidelivery = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="string"><span class="delimiter">'</span><span class="content">0321601912</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Continuous Delivery:</span><span class="delimiter">'</span></span>)

        [buildingMicroservices, releaseIt, cidelivery]
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Annotate the class with <code>@RabbitListener</code> to indicate that this bean will consume messages from RabbitMQ.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Annotate the method with <code>@Queue</code>. This listener will listen to messages in the <code>catalogue</code> queue.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The previous service responds a <code>List&lt;Book&gt;</code>. Create the <code>Book</code> POJO:</p>
</div>
<div class="listingblock">
<div class="title">bookcatalogue/src/main/groovy/example/micronaut/Book.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example.micronaut

<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">groovy.transform.EqualsAndHashCode</span>
<span class="keyword">import</span> <span class="include">groovy.transform.ToString</span>
<span class="keyword">import</span> <span class="include">io.micronaut.serde.annotation.Serdeable</span>

<span class="annotation">@Serdeable</span>
<span class="annotation">@CompileStatic</span>
<span class="annotation">@EqualsAndHashCode</span>
<span class="annotation">@ToString</span>
<span class="type">class</span> <span class="class">Book</span> {

    <span class="directive">final</span> <span class="predefined-type">String</span> isbn
    <span class="directive">final</span> <span class="predefined-type">String</span> name

    <span class="predefined-type">Book</span>(<span class="predefined-type">String</span> isbn, <span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.isbn = isbn
        <span class="local-variable">this</span>.name = name
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="inventory-microservice">5.2. Inventory microservice</h3>
<div class="paragraph">
<p>Create the <code>bookinventory</code> microservice using the <a href="https://docs.micronaut.io/latest/guide/#cli">Micronaut Command Line Interface</a> or with <a href="https://launch.micronaut.io">Micronaut Launch</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mn create-app --features=rabbitmq,graalvm example.micronaut.bookinventory --build=maven --lang=groovy</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you don&#8217;t specify the <code>--build</code> argument, Gradle with the <a href="https://docs.gradle.org/current/userguide/kotlin_dsl.html">Kotlin DSL</a> is used as the build tool. <br/> If you don&#8217;t specify the <code>--lang</code> argument, Java is used as the language.<br/> If you don&#8217;t specify the <code>--test</code> argument, JUnit is used for Java and Kotlin, and Spock is used for Groovy.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you use Micronaut Launch, select Micronaut Application as application type and add the <code>rabbitmq</code> and <code>graalvm</code> features.</p>
</div>
<div class="paragraph">
<p>The previous command creates a directory named <code>bookinventory</code> and a Micronaut application inside it with default package <code>example.micronaut</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you have an existing Micronaut application and want to add the functionality described here, you can view the dependency and configuration changes from the specified features, and apply those changes to your application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://micronaut.io/launch?features=yaml&amp;features=rabbitmq&amp;features=serialization-jackson&amp;features=validation&amp;lang=GROOVY&amp;build=MAVEN&amp;test=SPOCK&amp;name=bookinventory&amp;type=DEFAULT&amp;package=example.micronaut&amp;activity=diff" target="_blank" rel="noopener">Diff</a></p>
</div>
<div class="paragraph">
<p>The previous command creates a directory named <code>bookinventory</code> and a Micronaut application inside it with default package <code>example.micronaut</code>.</p>
</div>
<div class="sect3">
<h4 id="create-rabbitmq-exchange-queue-and-binding-2">5.2.1. Create RabbitMQ exchange, queue and binding</h4>
<div class="paragraph">
<p>Copy the <code>ChannelPoolListener</code> class you created in the <code>bookcatalogue</code> microservice to <code>bookinventory/src/main/groovy/example/micronaut/bookcatalogue</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-consumer-2">5.2.2. Create consumer</h4>
<div class="paragraph">
<p>Create a <code>BookInventoryService</code> class to handle incoming RPC requests into the <code>bookinventory</code> microservice:</p>
</div>
<div class="listingblock">
<div class="title">bookinventory/src/main/groovy/example/micronaut/BookInventoryService.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example.micronaut

<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.annotation.Queue</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.annotation.RabbitListener</span>

<span class="keyword">import</span> <span class="include">jakarta.validation.constraints.NotBlank</span>

<span class="annotation">@CompileStatic</span>
<span class="annotation">@RabbitListener</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="type">class</span> <span class="class">BookInventoryService</span> {

    <span class="annotation">@Queue</span>(<span class="string"><span class="delimiter">'</span><span class="content">inventory</span><span class="delimiter">'</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="predefined-type">Boolean</span> stock(<span class="annotation">@NotBlank</span> <span class="predefined-type">String</span> isbn) {
        bookInventoryByIsbn(isbn).map(bi -&gt; bi.getStock() &gt; <span class="integer">0</span>).orElse(<span class="predefined-constant">null</span>)
    }

    <span class="directive">private</span> Optional&lt;BookInventory&gt; bookInventoryByIsbn(<span class="predefined-type">String</span> isbn) {
        <span class="keyword">if</span> (isbn == <span class="string"><span class="delimiter">'</span><span class="content">1491950358</span><span class="delimiter">'</span></span>) {
            <span class="keyword">return</span> Optional.of(<span class="keyword">new</span> BookInventory(isbn, <span class="integer">4</span>))
        }
        <span class="keyword">if</span> (isbn == <span class="string"><span class="delimiter">'</span><span class="content">1680502395</span><span class="delimiter">'</span></span>) {
            <span class="keyword">return</span> Optional.of(<span class="keyword">new</span> BookInventory(isbn, <span class="integer">0</span>))
        }
        <span class="keyword">return</span> Optional.empty()
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Annotate the class with <code>@RabbitListener</code> to indicate that this bean will consume messages from RabbitMQ.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Annotate the method with <code>@Queue</code>. This listener will listen to messages in <code>inventory</code> queue.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The previous service uses <code>BookInventory</code> POJO. Create it:</p>
</div>
<div class="listingblock">
<div class="title">bookinventory/src/main/groovy/example/micronaut/BookInventory.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example.micronaut

<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">groovy.transform.EqualsAndHashCode</span>
<span class="keyword">import</span> <span class="include">io.micronaut.serde.annotation.Serdeable</span>

<span class="annotation">@Serdeable</span>
<span class="annotation">@CompileStatic</span>
<span class="annotation">@EqualsAndHashCode</span>
<span class="type">class</span> <span class="class">BookInventory</span> {

    <span class="directive">final</span> <span class="predefined-type">String</span> isbn
    <span class="directive">final</span> <span class="predefined-type">Integer</span> stock

    BookInventory(<span class="predefined-type">String</span> isbn, <span class="predefined-type">Integer</span> stock) {
        <span class="local-variable">this</span>.isbn = isbn
        <span class="local-variable">this</span>.stock = stock
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="recommendation-microservice">5.3. Recommendation microservice</h3>
<div class="paragraph">
<p>Create the <code>bookrecommendation</code> microservice using the <a href="https://docs.micronaut.io/latest/guide/#cli">Micronaut Command Line Interface</a> or with <a href="https://launch.micronaut.io">Micronaut Launch</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mn create-app --features=rabbitmq,reactor,graalvm example.micronaut.bookrecommendation --build=maven --lang=groovy</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you don&#8217;t specify the <code>--build</code> argument, Gradle with the <a href="https://docs.gradle.org/current/userguide/kotlin_dsl.html">Kotlin DSL</a> is used as the build tool. <br/> If you don&#8217;t specify the <code>--lang</code> argument, Java is used as the language.<br/> If you don&#8217;t specify the <code>--test</code> argument, JUnit is used for Java and Kotlin, and Spock is used for Groovy.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you use Micronaut Launch, select Micronaut Application as application type and add the <code>rabbitmq</code>, <code>reactor</code>, and <code>graalvm</code> features.</p>
</div>
<div class="paragraph">
<p>The previous command creates a directory named <code>bookrecommendation</code> and a Micronaut application inside it with default package <code>example.micronaut</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you have an existing Micronaut application and want to add the functionality described here, you can view the dependency and configuration changes from the specified features, and apply those changes to your application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://micronaut.io/launch?features=yaml&amp;features=rabbitmq&amp;features=reactor&amp;features=serialization-jackson&amp;lang=GROOVY&amp;build=MAVEN&amp;test=SPOCK&amp;name=bookrecommendation&amp;type=DEFAULT&amp;package=example.micronaut&amp;activity=diff" target="_blank" rel="noopener">Diff</a></p>
</div>
<div class="sect3">
<h4 id="create-rabbitmq-exchange-queue-and-binding-3">5.3.1. Create RabbitMQ exchange, queue and binding</h4>
<div class="paragraph">
<p>Copy the <code>ChannelPoolListener</code> class you created in the <code>bookcatalogue</code> microservice to <code>bookrecommendation/src/main/java/example/micronaut/bookcatalogue</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-clients">5.3.2. Create clients</h4>
<div class="paragraph">
<p>Let&#8217;s create two interfaces to send messages to RabbitMQ. The Micronaut framework will implement the interfaces at compilation time.
Create <code>CatalogueClient</code>:</p>
</div>
<div class="listingblock">
<div class="title">bookrecommendation/src/main/groovy/example/micronaut/CatalogueClient.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example.micronaut

<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.annotation.Binding</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.annotation.RabbitClient</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.annotation.RabbitProperty</span>
<span class="keyword">import</span> <span class="include">org.reactivestreams.Publisher</span>

<span class="annotation">@CompileStatic</span>
<span class="annotation">@RabbitClient</span>(<span class="string"><span class="delimiter">'</span><span class="content">micronaut</span><span class="delimiter">'</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@RabbitProperty</span>(name = <span class="string"><span class="delimiter">'</span><span class="content">replyTo</span><span class="delimiter">'</span></span>, value = <span class="string"><span class="delimiter">'</span><span class="content">amq.rabbitmq.reply-to</span><span class="delimiter">'</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
<span class="type">interface</span> CatalogueClient {

    <span class="annotation">@Binding</span>(<span class="string"><span class="delimiter">'</span><span class="content">books.catalogue</span><span class="delimiter">'</span></span>) <i class="conum" data-value="3"></i><b>(3)</b>
    Publisher&lt;<span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt;&gt; findAll(<span class="type">byte</span><span class="type">[]</span> data) <i class="conum" data-value="4"></i><b>(4)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Send the messages to exchange <code>micronaut</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set the <code>replyTo</code> property to <code>amq.rabbitmq.reply-to</code>. This is a special queue that always exists and does not need
to be created. That is why we did not create the queue in the <code>ChannelInitializer</code>. RabbitMQ uses that queue in a
special way, and setting the value of the property <code>replyTo</code> to that queue will enable this call as an RPC one. RabbitMQ
will create a temporary queue for the callback.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set the routing key.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Define the method that will "mirror" the one in the consumer. Keep in mind that in the consumer, it is not possible to
return a reactive type, but on the client side it is. Also, it is necessary to send something, even if it&#8217;s not
used in the consumer.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Create <code>InventoryClient.java</code>:</p>
</div>
<div class="listingblock">
<div class="title">bookrecommendation/src/main/groovy/example/micronaut/InventoryClient.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example.micronaut

<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.annotation.Binding</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.annotation.RabbitClient</span>
<span class="keyword">import</span> <span class="include">io.micronaut.rabbitmq.annotation.RabbitProperty</span>
<span class="keyword">import</span> <span class="include">reactor.core.publisher.Mono</span>

<span class="annotation">@CompileStatic</span>
<span class="annotation">@RabbitClient</span>(<span class="string"><span class="delimiter">'</span><span class="content">micronaut</span><span class="delimiter">'</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@RabbitProperty</span>(name = <span class="string"><span class="delimiter">'</span><span class="content">replyTo</span><span class="delimiter">'</span></span>, value = <span class="string"><span class="delimiter">'</span><span class="content">amq.rabbitmq.reply-to</span><span class="delimiter">'</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
<span class="type">interface</span> InventoryClient {

    <span class="annotation">@Binding</span>(<span class="string"><span class="delimiter">'</span><span class="content">books.inventory</span><span class="delimiter">'</span></span>) <i class="conum" data-value="3"></i><b>(3)</b>
    Mono&lt;<span class="predefined-type">Boolean</span>&gt; stock(<span class="predefined-type">String</span> isbn) <i class="conum" data-value="4"></i><b>(4)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Send the messages to exchange <code>micronaut</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set the <code>replyTo</code> property to <code>amq.rabbitmq.reply-to</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set the routing key.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Define the method that will "mirror" the one in the consumer. As we did with <code>CatalogueClient</code>, we use a reactive
type to wrap the result.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="create-the-controller">5.3.3. Create the controller</h4>
<div class="paragraph">
<p>Create a Controller that injects both clients.</p>
</div>
<div class="listingblock">
<div class="title">bookrecommendation/src/main/groovy/example/micronaut/BookController.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example.micronaut


<span class="keyword">import</span> <span class="include">io.micronaut.http.annotation.Controller</span>
<span class="keyword">import</span> <span class="include">io.micronaut.http.annotation.Get</span>
<span class="keyword">import</span> <span class="include">org.reactivestreams.Publisher</span>
<span class="keyword">import</span> <span class="include">reactor.core.publisher.Flux</span>

<span class="annotation">@Controller</span>(<span class="string"><span class="delimiter">'</span><span class="content">/books</span><span class="delimiter">'</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="type">class</span> <span class="class">BookController</span> {

    <span class="directive">private</span> <span class="directive">final</span> CatalogueClient catalogueClient <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="directive">private</span> <span class="directive">final</span> InventoryClient inventoryClient <i class="conum" data-value="2"></i><b>(2)</b>

    BookController(CatalogueClient catalogueClient, InventoryClient inventoryClient) { <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="local-variable">this</span>.catalogueClient = catalogueClient
        <span class="local-variable">this</span>.inventoryClient = inventoryClient
    }

    <span class="annotation">@Get</span> <i class="conum" data-value="3"></i><b>(3)</b>
    Publisher&lt;BookRecommendation&gt; index() {
        Flux.from(catalogueClient.findAll(<span class="predefined-constant">null</span>))
                .flatMap(<span class="key">Flux</span>::fromIterable)
                .flatMap(book -&gt; Flux.from(inventoryClient.stock(book.isbn))
                        .filter(<span class="predefined-type">Boolean</span>::booleanValue)
                        .map(response -&gt; book))
                .map(book -&gt; <span class="keyword">new</span> BookRecommendation(book.name))
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The class is defined as a controller with the <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/Controller.html">@Controller</a> annotation mapped to the path <code>/books</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Clients are injected via constructor injection</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/Get.html">@Get</a> annotation maps the <code>index</code> method to an HTTP GET request on <code>/books</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The previous controller returns a <code>Publisher&lt;BookRecommendation&gt;</code>. Create the <code>BookRecommendation</code> POJO:</p>
</div>
<div class="listingblock">
<div class="title">bookrecommendation/src/main/groovy/example/micronaut/BookRecommendation.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example.micronaut

<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">groovy.transform.EqualsAndHashCode</span>
<span class="keyword">import</span> <span class="include">io.micronaut.serde.annotation.Serdeable</span>

<span class="annotation">@CompileStatic</span>
<span class="annotation">@EqualsAndHashCode</span>
<span class="annotation">@Serdeable</span>
<span class="type">class</span> <span class="class">BookRecommendation</span> {

    <span class="directive">final</span> <span class="predefined-type">String</span> name;

    BookRecommendation(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rabbitmq-and-the-micronaut-framework">6. RabbitMQ and the Micronaut Framework</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As <a href="#test-resources">mentioned above</a> a shared dockerized instance of RabbitMQ will be started automatically when you run the application, however if you want to start your own instance of RabbitMQ, you have a few options:</p>
</div>
<div class="sect2">
<h3 id="install-rabbitmq-via-docker">6.1. Install RabbitMQ via Docker</h3>
<div class="paragraph">
<p>The fastest way to start using <a href="https://hub.docker.com/_/rabbitmq/">RabbitMQ is via Docker</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">docker run --rm -it \
        -p 5672:5672 \
        -p 15672:15672 \
        rabbitmq:3.8.12-management</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="alternative-methods">6.2. Alternative methods</h3>
<div class="paragraph">
<p>Alternatively you can <a href="https://www.rabbitmq.com/download.html">install and run a local RabbitMQ instance</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-the-application">7. Running the Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Configure <code>bookinventory</code> to run on port 8082:</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<a href="https://micronaut.io/2023/02/19/micronaut-framework-4-0-and-snakeyaml-transitive-dependency/">Since Micronaut Framework 4.0, to use YAML configuration, you have to add the YAML dependency</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">bookinventory/src/main/resources/application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">server</span>:
    <span class="key">port</span>: <span class="string"><span class="content">8082 </span></span><i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>Run <code>bookinventory</code> microservice:</p>
</div>
<div class="listingblock">
<div class="title">bookinventory</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./mvnw mn:run</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>13:30:22.426 [main] INFO  io.micronaut.runtime.Micronaut - Startup completed in 742ms. Server Running: 1 active message listeners.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configure <code>bookcatalogue</code> to run on port 8081:</p>
</div>
<div class="listingblock">
<div class="title">bookcatalogue/src/main/resources/application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">server</span>:
    <span class="key">port</span>: <span class="string"><span class="content">8081 </span></span><i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>Run <code>bookcatalogue</code> microservice:</p>
</div>
<div class="listingblock">
<div class="title">bookcatalogue</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./mvnw mn:run</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>13:31:19.887 [main] INFO  io.micronaut.runtime.Micronaut - Startup completed in 949ms. Server Running: 1 active message listeners.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configure <code>bookrecommendation</code> to run on port 8080:</p>
</div>
<div class="listingblock">
<div class="title">bookrecommendation/src/main/resources/application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">server</span>:
    <span class="key">port</span>: <span class="string"><span class="content">8080 </span></span><i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
8080 is the default port if you don&#8217;t specify <code>micronaut.server.port</code> property
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run <code>bookrecommendation</code> microservice:</p>
</div>
<div class="listingblock">
<div class="title">bookrecommendation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./mvnw mn:run</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>13:32:06.045 [main] INFO  io.micronaut.runtime.Micronaut - Startup completed in 959ms. Server Running: http://localhost:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can run a <code>curl</code> command to test the whole application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl http://localhost:8080/books</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[{<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Building Microservices</span><span class="delimiter">&quot;</span></span>}]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="next-steps">8. Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Read more about <a href="https://micronaut-projects.github.io/micronaut-rabbitmq/latest/guide/#rpc">RabbitMQ RPC Support</a> in the Micronaut framework.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="license">9. License</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All guides are released with an <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache license 2.0 license</a> for the code and a <a href="https://creativecommons.org/licenses/by/4.0/deed.en">Creative Commons Attribution 4.0</a> license for the writing and media (images&#8230;&#8203;).
</td>
</tr>
</table>
</div>

            </div>
        </div>
    </div>
</main>

<footer id="footer">
    <div class="container">

        <div class="row">
            <div class="col-sm-5 footer-left">

                <div id="text-14" class="widget widget_text">
                    <div class="textwidget">
                        <p>
                            <a href="https://micronaut.io/foundation/"><img class="alignnone size-medium wp-image-3736" src="./images/micronaut_foundation_horizontal_white.svg" alt="Micronaut Foundation"/></a>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-sm-7 footer-right">

                <ul class="meta">

                    <li id="menu-item-2895" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2895">
                        <a href="https://micronaut.io/brand-guidelines/">Brand Guidelines</a>
                    </li>
                    <li id="menu-item-2894" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2894">
                        <a href="https://micronaut.io/community-guidelines/">Community Guidelines</a>
                    </li>
                    <li id="menu-item-3377" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-3377">
                        <a href="https://micronaut.io/privacy-policy/">Privacy Policy</a>
                    </li>

                </ul>

                <div id="nav_menu-2" class="widget widget_nav_menu">
                    <div class="menu-links-container">
                        <ul id="menu-links" class="menu">
                            <li class="menu-item menu-item-type-custom menu-item-object-custom "><a href="https://micronautpodcast.com"><i class="fa fa-podcast"><span class="sr-only">Podcast</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom "><a href="https://micronaut.io/feed/rss/"><i class="fa fa-feed"><span class="sr-only">Feed</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom "><a href="mailto:info@micronaut.io"><i class="fas fa-envelope"><span class="sr-only">Mail</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://twitter.com/micronautfw"><i class="fab fa-twitter"><span class="sr-only">Twitter</span></i></a></li>
                            <li id="menu-item-6740" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6740"><a href="https://fosstodon.org/@micronaut"><i class="fab fa-mastodon"><span class="sr-only">Mastodon</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://discord.gg/9xRFsHv98T"><i class="fab fa-discord"><span class="sr-only">Discord</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://github.com/micronaut-projects/"><i class="fab fa-github"><span class="sr-only">GitHub</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.youtube.com/@MicronautFramework"><i class="fab fa-youtube"><span class="sr-only">YouTube</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.linkedin.com/showcase/micronaut"><i class="fab fa-linkedin"><span class="sr-only">LinkedIn</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.twitch.tv/micronautfw"><i class="fab fa-twitch"><span class="sr-only">Twitch</span></i></a></li>
                        </ul>
                    </div>
                </div>
                <div id="text-5" class="widget widget_text">
                    <div class="textwidget">
                        <p>
                            <small>Guides are licensed under <a href="https://creativecommons.org/licenses/by/4.0/deed.en">CC BY 4.0</a> for the writing/media and <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache.2.0</a> for the code</small>
                        </p>
                    </div>
                </div>

            </div>
        </div>
    </div>
</footer>
</body>
</html>
